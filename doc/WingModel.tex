\chapter{Model skrzyd³a}

Poni¿szy rozdzia³ zawiera opis oraz analizê modelu matematycznego skrzyd³a podlegaj¹cego zjawisku flatteru.

\section{Model matematyczny}

Model matematyczny skrzyd³a zosta³ zaczerpniêty z \cite{WaszakModel}. Na model sk³ada siê dynamika strukturalna, aerodynamika quasi-stacjonarna, dynamika elementu wykonawczego oraz model turbulencji (rys.~\ref{RysModelSkrzydla}).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{ModelSkrzydla.png}
\caption{Schemat blokowy modelu skrzyd³a.}
\label{RysModelSkrzydla}
\end{figure}

Postaci odpowiednio wektora stanu, wejœciowego i wyjœciowego s¹ nastêpuj¹ce:
\begin{align*}
x &= [ h, \theta, \dot{h}, \dot{\theta}, \dot{\delta}, \delta, t_1, t_2] \\
u &= [ \delta_c, \eta ] \\
y &= [ h, \theta, \dot{h}, \dot{\theta}, \delta, w_g, \dot{w_g}, \ddot{h}, \ddot{\theta} ] 
\end{align*}

Znaczenie poszczególnych symboli wyjaœniono w tabeli~\ref{TabModelSkrzydla}.

%\begin{center}
\begin{table}[hbt]
\centering
\begin{tabular}{|c|c|c|}
\hline
symbol & opis & jedn. \\
\hline
\( h \) & przemieszczenie pionowe profilu ref. & [m] \\
\( \theta \) & skrêcenie skrzyd³a & [rad] \\
\( \delta_c \) & wartoœæ zadana wychylenia lotki  & [rad] \\
\( \delta \) & wychylenie lotki & [rad] \\
\( \eta \) & sygna³ turbulencji  & [-] \\
\( t_1, t_2 \) & stany zwi¹zane z modelem turbulencji & [-] \\
\( w_g \) & pionowa wartoœæ podmuchu & [m/s] \\
\hline
\end{tabular}
\caption{Zmienne u¿yte w modelu}
\label{TabModelSkrzydla}
\end{table}
%\end{center}

\subsubsection{Model strukturalny}

Uk³ad równañ \ref{EqModelStruktury} opisuje drgania skrêtne i giêtne skrzyd³a~\cite{WaszakModel}.

\begin{equation}
\left[ \begin{array}{cc} m & s_{h\theta} \\ s_{h\theta} & I_\theta \\ \end{array} \right] 
\left[ \begin{array}{c} \ddot{h} \\ \ddot{\theta} \end{array} \right]
+ \left[ \begin{array}{cc} K_h & 0 \\ 0 & K_\theta \\ \end{array} \right]
\left[ \begin{array}{c} h \\ \theta \end{array} \right]
= \left[ \begin{array}{c} m \\ s_{h\theta} \end{array} \right] g
+ \left[ \begin{array}{c} Q_h \\ Q_\theta \end{array} \right]
\label{EqModelStruktury}
\end{equation}

Wyra¿enia \( m \), \(I_\theta\) to masy uogólnione postaci ruchu giêtnego i skrêtnego. Wyra¿enie \( s_{h\theta} \) to wspó³czynnik sprzê¿enia miêdzy dwoma stopniami swobody. \( K_h \), \(K_\theta\) to odpowiednio sztywnoœæ na zginanie i skrêcanie. Wreszcie \(Q_h\) i \(Q_\theta\) to uogólnione si³y dzia³aj¹ce na obiekt.

%\( K_h \), \(K_\theta\) to odpowiednio sztywnoœæ na zginanie i skrêcanie (TODO jak to siê nazywa: przetransponowane/uogólnione do profilu odniesienia?)

Jak siê okazuje wspó³czynnik sprzê¿enia drgañ giêtnych i skrêtnych \( s_{h\theta} \), którego wartoœæ wynika z po³o¿enia CG skrzyd³a wzglêdem SSP, ma decyduj¹ce znaczenie na to kiedy i czy w ogóle wyst¹pi zjawisko flatteru.

\begin{equation}
s_{h\theta} = m \cdot x_{cg}
\end{equation}

\subsubsection{Model aerodynamiki quasi-stacjonarnej}
(TODO wyjaœniæ dlaczego stosujemy profil referencyjny, jego po³o¿enie wzd³u¿ skrzyd³a)

Standardow¹ metod¹ szacowania si³ aerodynamicznych jest u¿ycie pochodnych stabilnoœciowych i sterowania (stability and control derivatives). Si³y aerodynamiczne mog¹ zostaæ przedstawione jako funkcje liniowe k¹ta natarcia \( \alpha \), wychylenia powierzchni sterowych \(\delta\) oraz ich pochodnych wzglêdem czasu (\ref{EqSilyAero}). Wartoœci wspó³czynników aerodynamicznych zosta³y zawarte w tabeli~\ref{TabWspAero}

\begin{equation}
\label{EqSilyAero}
\begin{split}
L = & qSC_L = \\
 & qS \left[ C_{L_0} +C_{L_\alpha} \alpha + C_{L_\delta} \delta 
+ \frac{\bar{c}}{2U_0} \left(C_{L_{\dot{\alpha}}} \dot{\alpha} 
+ C_{L_q} \dot{\theta} + C_{L_{\dot{\delta}}} \dot\delta \right) \right]
\\
M = & qS\bar{c}C_M = \\
 & qS\bar{c} \left[ C_{M_0} +C_{M_\alpha} \alpha + C_{M_\delta} \delta + \frac{\bar{c}}{2U_0} (C_{M_{\dot{\alpha}}} \dot{\alpha} + C_{M_q} \dot{\theta} + C_{M_{\dot{\delta}}} \dot\delta) \right]
\end{split}
\end{equation}

\begin{table}[hbt]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
Symbol & opis & Wartoœæ & Jedn. \\
\hline
\( C_{L_0} \) & wsp. si³y noœnej dla \(\alpha = 0\) & 0 & \( [-] \) \\
\( C_{M_0} \) & wsp. momentu dla \(\alpha = 0\) & 0 & \( [-] \) \\
\( C_{L_\alpha} \) & wsp. si³y noœnej wzglêdem k¹ta natarcia & 4,584 & \( [1/rad] \) \\
\( C_{M_\alpha} \) & wsp. momentu wzgl. k¹ta natarcia & 1,49 & \( [1/rad] \) \\
\( C_{L_{\dot{\alpha}}} \) & wsp. si³y noœnej wzgl. pochodnej k¹ta natarcia & -3,1064 & \( [1/rad] \) \\
\( C_{L_q} \) & wsp. si³y noœnej wzgl. prêdkoœci pochylania & 2,5625 & \( [1/rad] \) \\
\( C_{M_{\dot{\alpha}}} \) & wsp. momentu wzgl. pochodnej k¹ta natarcia & -2,6506 & \( [1/rad] \) \\
\( C_{M_q} \) & wsp. si³y noœnej wzgl. prêdkoœci pochylania & -0,4035 & \( [1/rad] \) \\
\( C_{L_\delta} \) & wsp. si³y noœnej wzgl. k¹ta wychylenia lotki& 0,63 & \( [1/rad] \) \\
\( C_{L_{\dot{\delta}}} \) & wsp. si³y noœnej wzgl. pochodnej k¹ta wychylenia lotki & 0 & \( [1/rad] \) \\
\( C_{M_\delta} \) & wsp. momentu wzgl. k¹ta wychylenia lotki& -0,0246 & \( [1/rad] \) \\
\( C_{M_{\dot{\delta}}} \) & wsp. momentu wzgl. pochodnej k¹ta wychylenia lotki& 0 & \( [1/rad] \) \\
\( x_{ac} \) & po³o¿enie AC wzglêdem SSP & 0,0938 & \( [m] \) \\
\( S \) & powierzchnia p³ata & 5,25 & \( [m^2] \) \\
\( \bar{c} \) & œrednia ciêciwa aerodynamiczna & 0,75 & \( [m] \) \\
\hline
\end{tabular}
\caption{Wspó³czynniki aerodynamiczne modelu skrzyd³a.}
\label{TabWspAero}
\end{table}

Model aerodynamiki oparty na wspó³czynnikach jest raczej uproszczonym podejœciem, ale w zupe³noœci wystarczaj¹cy aby uchwyciæ najwa¿niejsze cechy zjawiska flatteru~\cite{WaszakModel}.

Niestacjonarny charakter modelu aerodynamiki wynika z uwzglêdnienia wspó³czynników wzglêdem pochodnych (np. \( C_{L_{\dot\alpha}} \) ). 

Wyra¿enie (\ref{EqKatNatarcia}) pozwala wyznaczyæ k¹t natarcia w chwili \(t\).

\begin{equation}
\alpha(t) = \theta(t) + \frac{\dot{h}(t)}{U_0} + \frac{x_{ac} \dot{\theta}(t)}{U_0} - \frac{w_g(t)}{U_0}
\label{EqKatNatarcia}
\end{equation}

Symbol \( U_0 \) oznacza prêdkoœæ lotu w \(m/s\), a symbol  \( x_{ac} \) - odleg³oœæ œrodka aerodynamicznego od SSP w metrach.

\subsubsection{Model elementu wykonawczego}
Parametry si³ownika zosta³y równie¿ zaczerpniête z \cite{WaszakModel}. Model drugiego rzêdu przedstawia równanie~(\ref{EqSilownik}).

\begin{equation}
\frac{\delta(s)}{\delta_c(s)} = \frac{k\omega^2}{s^2 + 2\zeta\omega s + \omega^2}
\label{EqSilownik}
\end{equation} 

Wspó³czynnik \( k_\delta\) okreœla wzmocnienie, \(\omega_\delta\) czêstoœæ, a \(\zeta_\delta\) t³umienie uk³adu. Wartoœci liczbowe zosta³y zawarte w tabeli~\ref{TabActuatorParams}.

\begin{table}[hbt]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
Symbol & Opis & Wartoœæ & Jedn. \\
\hline
k & Wspó³czynnik wzmocnienia & 1,02 & - \\
\(\omega_\delta\) & Czêstoœæ drgañ w³asnych & 165,3 & rad/s \\
\(\zeta_\delta\) & Wspó³czynnik t³umienia & 0.56 & - \\
\hline
\end{tabular}
\caption{Wartoœci liczbowe modelu elementu wykonawczego}
\label{TabActuatorParams}
\end{table}

\subsubsection{Model turbulencji}
W rzeczywistej atmosferze powietrze jest w ci¹g³ym ruchu. Gdy statek powietrzny porusza siê ze sta³¹ prêdkoœci¹, to prêdkoœæ op³ywu powietrza wzglêdem niego w dowolnym punkcie wynosi 
\begin{equation}
U(t,x,y,z) = U_0 + U_g(t,x,y,z)
\end{equation}
Sk³adnik \( U_g(t,x,y,z) \) to turbulencja, czyli zaburzenie ruchu powietrza. W prostym modelu atmosfery zazwyczaj zak³ada siê, ¿e w danej chwili \( t\) zaburzenie jest takie samo w ka¿dym miejscu. Dodatkowo w analizie przep³ywu wokó³ skrzyd³a istotne znaczenie ma tylko sk³adowa pionowa wektora turbulencji \(w_g(t)\).

Doœwiadczalne dane pomiarowe turbulencji wystêpuj¹ zazwyczaj w postaci widmowej gêstoœci mocy, dla okreœlonych warunków atmosferycznych, lecz zamiast zwyk³ej czêstotliwoœci mamy czêstotliwoœæ przestrzenn¹:
\begin{equation} % TODOczy to potrzebne?
\Omega = \frac{\omega}{U_0}
\end{equation}
Istniej¹ dwie praktyczne analityczne reprezentacje widmowej gêstoœci mocy turbulencji u¿ywane w badaniach nad dynamik¹ lotu. Pierwsze - spektrum Von Karmana lepiej oddaje dane pomiarowe, ale do analitycznych badañ chêtniej wykorzystywany jest prostszy model Drydena, którego postaæ po przekszta³ceniu przedstawia równanie (\ref{EqDryden}).
\begin{equation}
\frac{w_g(s)}{\eta_g(s)} = \alpha_t \frac{s + \beta_t}{\left( s + \beta_t \right) ^2}
\label{EqDryden}
\end{equation}
Mo¿na ten model traktowaæ jako filtr, którego charakterystyka czêstotliwoœciowa odpowiada widmowej gêstoœci mocy. Wejœciem filtra jest bia³y szum \(eta(t)\).

Wartoœci parametrów modelu turbulencji zaczerpniête z~\cite{WaszakModel} dla prêdkoœci lotu zbli¿onej do prêdkoœci krytycznej flatteru wynosz¹:\\*
\( \alpha_t = 2,49 \) \\*
\( \beta_t = 99 \) \\*

Rysunek (\ref{RysTurbulencja}) przedstawia pionow¹ sk³adow¹ turbulencji \( w_g(t) \) dla przyk³adowego sygna³u wejœciowego modelu \(\eta(t)\).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth/2]{Turbulencja.eps}
\caption{Przyk³adowy przebieg sk³adowej pionowej turbulencji.}
\label{RysTurbulencja}
\end{figure}

\subsubsection{Pe³ny model w przestrzeni stanów}

\subsubsection{Wartoœci liczbowe - parametry}

Parametry wyjœciowego modelu zosta³y odpowiednio przeskalowane tak, aby w³aœciwoœci skrzyd³a odpowiada³y skrzyd³u MQ-1. Model jest parametryzowany prêdkoœci¹ i wysokoœci¹ lotu oraz poziomem paliwa w skrzyd³ach. Wysokoœæ lotu determinuje gêstoœæ powietrza, co razem z prêdkoœci¹ wyznacza ciœnienie dynamiczne. Poziom paliwa ma wp³yw na masê i moment bezw³adnoœci. 

Wartoœci parametrów (ewentualnie ich zakres) zosta³y zawarte w tabeli \ref{TabParametrySkrzydla}. Górne ograniczenie prêdkoœci jak i ciœnienia dynamicznego odpowiada prêdkoœci krytycznej flatteru, ale celem projektu jest zwiêkszenie tej prêdkoœci, a wiêc rozpatrywany zakres bêdzie jeszcze wiêkszy.

\begin{table}[hbt]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
Symbol & Opis & Wartoœæ & Jednostki \\
\hline
\( U_0 \) & prêdkoœæ lotu & 28 - 130 & \( [m/s] \) \\
\( H \) & wysokoœæ lotu & 0 - 11000 & \( [m] \) \\
\( q \) & ciœnienie dynamiczne & 500 - 4400 & \( [Pa]\) \\
\( m \) & uogólniona masa & 90 - 240 & \( [kg]\) \\
\( I_\theta \) & moment bezw³adnoœci & 7,56 - 15,12 & \( [kg \cdot m^2]\) \\
\( K_h \) & sztywnoœæ na zginanie & 50000 & \( [N/m]\) \\
\( K_\theta \) & sztywnoœæ na skrêcanie & 36000 & \( [Nm/rad]\) \\
\( \omega_h \) & czêstoœæ drgañ giêtnych & 22,3 - 36,4 & \( [rad/s]\) \\
\( \omega_\theta \) & czêstoœæ drgañ skrêtnych & 48,4 - 69 & \( [rad/s]\) \\
\( \zeta_h \) & wsp. t³umienia zginania & 0,0014 & \( [-]\) \\
\( \zeta_\theta \) & wsp. t³umienia skrêcania & 0,001 & \( [-]\) \\
\( \bar{x_{cg}} \) & wzglêdne po³o¿enie CG & 1 - 4,125 & \( [\%] \) \\
\hline
\end{tabular}
\caption{Zakres wartoœci parametrów modelu}
\label{TabParametrySkrzydla}
\end{table}

\section{Analiza modelu}
Rys. (\ref{RysOdpSkokowa}) przedstawia odpowiedŸ modelu skrzyd³a dla sygna³u skokowego na wejœciu \( \delta_c \), dla prêdkoœci poni¿ej prêdkoœci krytycznej \( U_0 = 0,55 V_k\). Rys. \ref{RysOdpTurb} przedstawia reakcjê modelu na typowy sygna³ turbulencji. Przebiegi wstêpnie potwierdzaj¹ poprawnoœæ modelu.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*3/4]{WingOdpControl.eps}
\caption{OdpowiedŸ uk³adu na sygna³ skokowy na wejœciu \(\delta_c\).}
\label{RysOdpSkokowa}
\end{figure}

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*3/4]{WingOdpTurb.eps}
\caption{OdpowiedŸ uk³adu na sygna³ turbulencji.}
\label{RysOdpTurb}
\end{figure}

\subsubsection{Analiza prêdkoœci lotu}
Dolnym ograniczeniem prêdkoœci lotu jest prêdkoœæ \(V_{min}\), dla której skrzyd³o jest w stanie wytworzyæ  si³ê noœn¹ wystarczaj¹c¹ do lotu poziomego.

Zak³ada siê, ¿e jedynym górnym ograniczeniem jest prêdkoœæ krytyczna flatteru \(V_k\). Wyznaczenie prêdkoœci krytycznej polega na odnalezieniu minimalnej prêdkoœci, dla której uk³ad przestaje byæ stabilny. Wp³yw na tê prêdkoœæ ma zarówno wysokoœæ lotu, jak i (poœrednio) poziom paliwa w skrzyd³ach (rys~\ref{RysPredkosci}).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*3/4]{Predkosci.eps}
\caption{Zale¿noœæ prêdkoœci \(V_{min}, V_k\) od wysokoœci i poziomu paliwa.}
\label{RysPredkosci}
\end{figure}

\subsubsection{Wêdrówka pierwiastków uk³adu}
Rys. (\ref{RysWingLocus}) przedstawia wêdrówkê pierwiastków uk³adu wzglêdem prêdkoœci lotu dla ró¿nych konfiguracji (poziomu paliwa).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{WingRootLocus.eps}
\caption{Linia pierwiastkowa wzglêdem prêdkoœci lotu, dla ró¿nego poziomu paliwa (czerwony - 0\%, zielony - 50\%, niebieski - 100\%).}
\label{RysWingLocus}
\end{figure}

Gdy uk³ad staje siê niestabilny - linia pierwiastkowa wkracza na dodatni¹ pó³p³aszczyznê czêœci rzeczywistej, wektor w³asny odpowiadaj¹cy niestabilnej wartoœci w³asnej przyjmuje postaæ charakterystyczn¹ dla flatteru. Drgania skrêtne s¹ przesuniête wzglêdem drgañ giêtnych o oko³o 90 stopni (rys.~\ref{RysKatThetaH}).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*2/3]{KatThetaH.eps}
\caption{Przesuniêcie fazowe drgañ skrêtnych wzglêdem drgañ giêtnych dla ró¿nej masy paliwa. W okolicach prêdkoœci flutteru wartoœæ przesuniêcia osi¹ga 90 stopni.}
\label{RysKatThetaH}
\end{figure}

\section{Model skrzyd³a z niepewnoœci¹}
Jak wynika z tabeli \ref{TabParametrySkrzydla} zakres zmiennoœci parametrów jest du¿y. Istnieje zatem ryzyko, ¿e rodzina modeli \( \mathcal{G}_r \) mo¿e byæ zbyt du¿a, aby jeden liniowy regulator zapewni³ stabilnoœæ w ca³ym obszarze pracy. 

Celem tego rozdzia³u jest ujêcie ca³ej rodziny modeli \( \mathcal{G}_r \) w jednym (niepewnym) modelu \( G_p(s) \).

\subsection{Rodzina modeli i model nominalny}
Model nominalny zwyczajowo jest wybierany dla œrednich wartoœci parametrów pracy \cite{RobustMatlab}. Model nominalny \( G_n(s) \) zosta³ wybrany arbitralnie dla prêdkoœci lotu równej prêdkoœci krytycznej \( U_0 = V_k \), oraz poziomu paliwa i wysokoœci lotu odpowiadaj¹cych wartoœciom œrednim (\(H = 5500 m, f_l = 50\%\)). Rysunek \ref{RodzinaModeli} przedstawia najwiêksz¹ wartoœæ osobliw¹ modelu nominalnego na tle rodziny modeli \( \mathcal{G}_r \).

TODO ewentualnie model nominalny dla najgorszego przypadku

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{RodzinaModeliGr.eps}
\caption{Najwiêksza wartoœæ osobliwa dla modeli nale¿¹cych do rodziny \( \mathcal{G}_r \) oraz dla modelu nominalnego \( G_n \)}
\label{RodzinaModeli}
\end{figure}

\subsection{Wybór modelu niepewnoœci}
Zakres zmiennoœci parametrów modelu mo¿na wprost prze³o¿yæ na niepewnoœæ parametryczn¹. Nale¿y zwróciæ jednak uwagê na siln¹ korelacjê niektórych parametrów (np. wynikaj¹cych ze wzrostu masy paliwa). Wykorzystanie parametrycznego modelu niepewnoœci mog³oby okazaæ siê zbyt zachowawcze i w rezultacie uniemo¿liwiæ syntezê regulatora. Np. sytuacja, w której moment bezw³adnoœci skrzyd³a \( I_\theta \) osi¹ga swoje maksimum, a jednoczeœnie masa \( m \) - minimum, jest nieosi¹galna.

Wobec tego postanowiono wykorzystaæ model niestrukturalny niepewnoœci, który mo¿e obj¹æ niepewnoœæ parametryczn¹ i dodatkowo zapewniæ wiêksz¹ stabilnoœæ obliczeñ \cite{RobustMatlab}.

\subsection{Model z niepewnoœci¹ parametryczn¹}
Zakres zmiennoœci wspó³czynników równañ matematycznych opisuj¹cych obiekt mo¿na wprost prze³o¿yæ na niepewnoœæ parametryczn¹. Przy skrajnie zachowawczym podejœcie nale¿a³oby uwzglêdniæ osobno ka¿dy z niepewnych parametrów modelu, np.:
\begin{align*}
m & \in <m_{min}, m_{max}> \\
I_\theta & \in <I_{\theta min}, I_{\theta max}> \\
&...
\end{align*}
Tak utworzona rodzina modeli na pewno objê³aby wszystkie mo¿liwoœci, ale jednoczeœnie zawiera³aby nierealne modele (np. dla maksymalnej masy skrzyd³a i jednoczeœnie minimalnego \( I_\theta \) ).

% TODO jakis wykres zeby pokazac jak bardzo moglyby roznic sie te modele?

Nale¿y zatem uwzglêdniæ siln¹ korelacjê niektórych wspó³czynników (np. wynikaj¹cych ze wzrostu masy paliwa). Tak na przyk³ad mo¿na przyj¹æ, ¿e masa \(m\), moment bezw³adnoœci \(I_\theta\) oraz wspó³czynnik sprzê¿enia \( s_{h\theta} \) zale¿¹ liniowo od poziomu paliwa (co jest pewnym przybli¿eniem):
\begin{align*}
m &= m_{min} + f_l(m_{max} - m_{min}) \\
I_\theta &= I_{\theta min} + f_l(I_{\theta max} - I_{\theta min}) \\
&...,\\
\end{align*}
gdzie \( f_l \in <0,1> \) to poziom paliwa.

Teraz odnosz¹c siê do przyk³adowego zapisu niepewnoœci parametrycznej \ref{NiepParam}, wektor niepewnych parametrów \( q \) przyjmie postaæ:
\begin{equation*}
q = [f_l, U_0],
\end{equation*}
gdzie \( f_l \in <0,1> \) to poziom paliwa, a \( U_0 \in <28,130> [m/s]\) - prêdkoœæ lotu. (Wysokoœæ lotu dla uproszczenia pominiêto).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{ParamUncertSample.eps}
\caption{Przebiegi czasowe losowych modeli dla skokowego sygna³u na wejœciu \( \delta_c \)}
\label{ParamUncertSample}
\end{figure}

Rys. \ref{ParamUncertSample} przedstawia przebiegi czasowe przyk³adowych modeli dla losowych wartoœci wektora \( q \).

\subsection{Ustrukturyzowana niepewnoœæ parametryczna}
Aby móc wykorzystaæ analizê strukturalnej wartoœci osobliwej, nale¿y tak przekszta³ciæ model obiektu, aby niepewnoœæ parametryczn¹ wyodrêbniæ do blokowej macierzy \( \Delta \). Metodologia tego przekszta³cenia zostanie przedstawiona na przyk³adzie modelu strukturalnego p³ata.

Uk³ad równañ \ref{EqModelStruktury} mo¿emy przedstawiæ w postaci diagramu blokowego jak na rys. \ref{SchematModelStr} (si³y ciê¿koœci zosta³y pominiête). 
\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*2/3]{SchematModelStr.png}
\caption{Diagram blokowy modelu strukturalnego p³ata}
\label{SchematModelStr}
\end{figure}
Niepewne parametry mo¿na przedstawiæ jako:
\begin{align*}
m &= \bar{m} (1+ p_m \delta_l)\\
I_\theta &= \bar{I_\theta} (1+ p_{I} \delta_l)\\
s_{h\theta} &= \bar{s_{h\theta}} (1+ p_{s} \delta_l)
\end{align*}
gdzie \( \bar{m}, \bar{I_\theta} , \bar{s_{h\theta}} \) to wartoœci œrednie, \( p_m, p_{I}, p_{s} \) procentowy zakres zmian odpowiednich parametrów, a \( \delta_l \) okreœla zmianê poziomu paliwa (wartoœæ \( \delta_l = -1 \) odpowiada poziomowi 0).
Cztery sta³e bloki na schemacie \ref{SchematModelStr} mog¹ zostaæ zast¹pione uk³adami uwzglêdniaj¹cymi zmianê \( \delta_l \), tak, jak to pokazano na rys{SchematModelStrU}. 
\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*2/3]{SchematModelStrU.png}
\caption{Diagram blokowy modelu strukturalnego z wyodrêbnionym niepewnym parametrem \( \delta_l \)}
\label{SchematModelStrU}
\end{figure}
Bior¹c pod uwagê, ¿e
\begin{equation*}
\frac{1}{m} = \frac{1}{\bar{m} (1+ p_m \delta_l)} = \frac{1}{\bar{m}} - \frac{p_m}{\bar{m}}\delta_l(1+p_m\delta_l)
\end{equation*}
odpowiednie macierze przyjm¹ postaæ:
\begin{equation*}
M_m = \left[ \begin{matrix}
-p_m & \frac{1}{\bar{m}} \\
-p_m & \frac{1}{\bar{m}}
\end{matrix}\right],
M_I = \left[ \begin{matrix}
0 & \bar{I_\theta} \\
p_I & \bar{I_\theta} 
\end{matrix}\right],
M_s = \left[ \begin{matrix}
0 & \bar{s_{h\theta}} \\
p_s & \bar{s_{h\theta}} 
\end{matrix}\right]
\end{equation*}


\subsection{Niepewnoœæ wzglêdna na wyjœciu}

Po dodaniu modelu niepewnoœci niestrukturalnej do modelu nominalnego otrzymamy model z niepewnoœci¹ (model zaburzony) \( G_p(s) \) (\ref{NiepewnoscNiestr}).

\begin{equation}
\begin{split}
G_p(s) &= (I + W_o(s)\cdot \Delta(s))\cdot G_n(s)\\
\| \Delta(s) \|_{\infty} & \leq 1
\end{split}
\label{NiepewnoscNiestr}
\end{equation}

Aby model \( G_p(s) \) obj¹³ ca³¹ rodzinê \( \mathcal{G}_r \) nale¿y tak dobraæ funkcjê wagow¹ \( W_o(s) \), aby by³a spe³niona zale¿noœæ (\ref{WarunekNaWu}).

\begin{equation}
\forall{G_i(s) \in \mathcal{G}_r} \forall{\omega \in \mathcal{R}} \sigma_{max}(G_p(j\omega)) \geq \sigma_{max}(G_i(j\omega))
\label{WarunekNaWu}
\end{equation}

Przy wykorzystaniu w³asnoœci maksymalnej wartoœci osobliwej (\ref{WlSigmaPlus} i \ref{WlSigmaMnozenie}), warunek na funkcjê wagow¹ mo¿na przedstawiæ w postaci (\ref{WarunekNaWu2}).

\begin{equation}
\forall{\omega \in \mathcal{R}}
|W_o(j\omega)| \geq \max_{G_i(s) \in \mathcal{G}_r} \left( \frac{\sigma_{max}(G_i(j\omega)) - \sigma_{max}(G_n(j\omega))}{\sigma_{max}(G_n(j\omega))} \right)
\label{WarunekNaWu2}
\end{equation}

Dla poprawnego wyniku wystarczy dobraæ skoñczony, ale reprezentatywny zbiór modeli \(G_i(s)\) takich, ¿e \( G_i(s) \in \mathcal{G}_r \). Do wyznaczenia funkcji wagowej modelu niepewnoœci wykorzystano funkcjê {\it ucover}, która dzia³a w dwóch krokach: \\ 
- najpierw dla pewnego zbioru czêstotliwoœci wyznacza optymaln¹ wartoœæ \( W_o(s) \)\\ 
- nastêpnie oblicza filtr okreœlonego rzêdu najlepiej dopasowany do tych wartoœci.

Rysunek (\ref{FigUncertOut}) przedstawia dopasowanie modelu z niepewnoœci¹ do rodziny \( \mathcal{G}_r \) w zale¿noœci od rzêdu funkcji wagowej. Uznano, ¿e rz¹d równy 5 jest dobrym kompromisem pomiêdzy z³o¿onoœci¹, a poziomem dopasowania.



\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{UncertOut.eps}
\caption{Najwiêksza wartoœæ osobliwa modelu z niepewnoœci¹ wzglêdn¹ na wyjœciu na tle rodziny modeli \( \mathcal{G}_r \)}
\label{FigUncertOut}
\end{figure}

\subsection{Niepewnoœæ wzglêdna na wejœciu}
Zasada wyznaczania funkcji wagowej \( W_i(s) \) modelu niepewnoœci wzglêdnej na wejœciu, opisanego równaniem (\ref{NiepewnoscNiestrIn}), jest podobna jak w przypadku niepewnoœci na wyjœciu.

\begin{equation}
\begin{split}
G_p(s) &= G_n(s) \cdot (I + W_i(s)\cdot \Delta(s))\\
\| \Delta(s) \|_{\infty} & \leq 1
\end{split}
\label{NiepewnoscNiestrIn}
\end{equation}

Rysunek (\ref{FigUncertIn}) przedstawia najwiêksz¹ wartoœæ osobliw¹ modelu z niepewnoœci¹ dla ró¿nych wartoœci rzêdu funkcji wagowych. Ponownie jako optymaln¹ wybrano funkcjê wagow¹ rzêdu 5. poniewa¿ dalszy wzrost tej wartoœci ma niewielki wp³yw na dopasowanie modelu.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{UncertIn.eps}
\caption{Najwiêksza wartoœæ osobliwa modelu z niepewnoœci¹ wzglêdn¹ na wejœciu na tle rodziny modeli \( \mathcal{G}_r \)}
\label{FigUncertIn}
\end{figure}

\subsection{Niepewnoœæ bezwzglêdna}
Model z niepewnoœci¹ bezwzglêdn¹ definiuje równanie (\ref{NiepewnoscAdd}). 

\begin{equation}
\begin{split}
G_p(s) &= G_n(s) + W_a(s)\cdot \Delta(s)\\
\| \Delta \|_{\infty} & \leq 1
\end{split}
\label{NiepewnoscAdd}
\end{equation}

Funkcja wagowa \( W_a(s) \) musi byæ tak dobrana, aby jej modu³ dla dowolnej czêstotliwoœci by³ wiêkszy od ró¿nicy maksymalnych wartoœci osobliwych modelu z rodziny \( \mathcal{G}_r \) i modelu nominalnego. Rysunek (\ref{FigUncertAdd}) przedstawia porównanie wartoœci osobliwej dla modeli z niepewnoœci¹ bezwzglêdn¹ dla funkcji wagowej rzêdu 3,5 oraz 7. Tym razem wzrost jakoœci modelu wraz ze wzrostem rzêdu funkcji wagowej jest istotny, dlatego do dalszej analizy wybrano model z funkcj¹ wagow¹ rzêdu 7.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{UncertAdd.eps}
\caption{Najwiêksza wartoœæ osobliwa modelu z niepewnoœci¹ bezwzglêdn¹ na tle rodziny modeli \( \mathcal{G}_r \)}
\label{FigUncertAdd}
\end{figure}

\subsection{Porównanie modeli niepewnoœci}

Model niepewnoœci powinien z jednej strony w pe³ni "obj¹æ" rodzinê modeli rzeczywistych (czyli spe³niæ warunek (\ref{WarunekNaWu})), z drugiej strony musi mo¿liwie ciasno przylegaæ do zbioru \( \mathcal{G}_r \). W dziedzinie czêstotliwoœci oznacza to, ¿e chcemy aby dla ka¿dej czêstotliwoœci górne oszacowanie maksymalnej wartoœci osobliwej by³o dok³adnie równej maksimum po maksymalnych wartoœciach osobliwych ze wszystkich \( G_i(s) \in \mathcal{G}_r \). Zak³adaj¹c ¿e warunek (\ref{WarunekNaWu}) jest spe³niony oznacza to, ¿e im ni¿ej le¿y wykres \( \sigma_{max}(G_p(j\omega) \) tym lepiej.

Na podstawie rysunku (\ref{FigUncertPorownanie}) mo¿na stwierdziæ, ¿e rodzinê modeli rzeczywistych najlepiej reprezentuje model z niepewnoœci¹ bezwzglêdn¹.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{UncertPorownanie.eps}
\caption{Porównanie najwiêkszej wartoœci osobliwej modeli z niepewnoœci¹}
\label{FigUncertPorownanie}
\end{figure}
