
\chapter{Wprowadzenie}
\fancyhead[LO]{\slshape \leftmark}
\fancyhead[RE]{\slshape \rightmark} 

\section{Zjawisko flatteru}
flatter jest niebezpiecznym zjawiskiem spotykanym w elastycznych strukturach poddanych si³om aerodynamicznym. flatter wystêpuje jako rezultat interakcji miêdzy si³ami aerodynamicznymi, sprê¿ystoœci oraz bezw³adnoœci. 

W miarê wzrostu prêdkoœci op³ywu powietrza, t³umienie strukturalne mo¿e byæ niewystarczaj¹ce aby rozproszyæ energiê dostarczan¹ z zewn¹trz. Jest to rodzaj drgañ samowzbudnych, czyli wymuszonych nieoscylacyjn¹ si³¹ zewnêtrzn¹. Szybko narastaj¹ca amplituda oscylacji mo¿e w krótkim czasie doprowadziæ do zniszczenia konstrukcji.

Klasyczny typ flatteru, nazywany giêtno-skrêtnym, przedstawiono na rys.~\ref{RysKlasycznyflatter}. Jest to wêdrówka profilu w pewnej reprezentacyjnej odleg³oœci od nasady skrzyd³a. Zniekszta³cenia skrzyd³a zwyczajowo opisuje siê dwiema zmiennymi: \\* 
\( h \) - strza³ka ugiêcia skrzyd³a [m] \\*
\( \theta \) - k¹t skrêcenia skrzyd³a [rad]. \\*
Najistotniejsz¹ cech¹ klasycznego flatteru jest opóŸnienie zginania wzglêdem skrêcania, które wynosi w przybli¿eniu \(90^\circ\).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{Klasycznyflatter.png}
\caption{Wêdrówka profilu w klasycznym zjawisku flatteru.}
\label{RysKlasycznyflatter}
\end{figure}

Tylko kombinacja dwóch postaci ruchu - skrêcania i zginania prowadzi do powstania flatteru. Ze wzrostem prêdkoœci, czêstotliwoœci tych postaci zbiegaj¹ siê, aby objawiæ siê jako jedna niestabilna postaæ ruchu po przekroczeniu prêdkoœci krytycznej.

Fundamentalny model opisuj¹cy zjawisko posiada dwa stopnie swobody (Rys.~\ref{RysPodstawowyModel}). Sprê¿yna 1 reprezentuje sztywnoœæ na zginanie, sprê¿yna 2 - sztywnoœæ na skrêcanie. Kszta³t profilu determinuje po³o¿enie œrodka aerodynamicznego (AC), natomiast po³o¿enie œrodka ciê¿koœci (CG) wynika z rozk³adu masy w skrzydle. Po³o¿enie œrodka si³ poprzecznych (EA) zale¿y od budowy skrzyd³a.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth/2]{PodstawowyModel.png}
\caption{Podstawowy model do opisu zjawiska flatteru.}
\label{RysPodstawowyModel}
\end{figure}

Poza omówionym rodzajem flatteru wystêpuj¹ jeszcze inne (np. flatter panelowy, galopowanie, buzz), ale nie stanowi¹ one tematu niniejszej pracy.

\section{Aktywny system t³umienia flatteru}
Podstawowym zadaniem projektanta jest uzyskanie takiej konstrukcji, w której flatter w ogóle nie wyst¹pi, lub prêdkoœæ przy której mo¿e wyst¹piæ bêdzie odpowiednio oddalona od maksymalnej prêdkoœci osi¹ganej przez samolot. Istnieje wiele sposobów radzenia sobie z tym problemem np. odpowiednie wywa¿enie skrzyd³a, zwiêkszenie sztywnoœci konstrukcji, specyficzna zmiana w³aœciwoœci aerodynamicznych. Te statyczne metody, chocia¿ bardzo skuteczne, maj¹ jednak wspóln¹ wadê - zawsze wi¹¿¹ siê ze wzrostem masy.

Wymagania wspó³czesnego lotnictwa zmuszaj¹ konstruktorów do minimalizowania masy struktury samolotu dla osi¹gniêcia coraz wiêkszej efektywnoœci. Mniejsza masa przy zachowaniu smuk³oœci sylwetki prowadzi niechybnie do mo¿liwoœci wyst¹pienia flatteru, a statyczne metody jego zapobiegania nie s¹ odpowiedzi¹ na problem. Kluczowym kierunkiem wysoko wydajnych konstrukcji jest zastosowanie \emph{systemu aktywnego t³umienia flatteru} - czyli wykorzystania istniej¹cych powierzchni sterowych do zapewnienia dynamicznej stabilnoœci~\cite{WaszakRobust}.

Skutecznoœæ takiego podejœcia zosta³a udowodniona w wielu badaniach \cite{WaszakRobust}, \cite{Waszakflatter} TODO - jeszcze jakieœ Ÿród³a).

\section{Obiekt sterowania}
Zadanie projektowe w niniejszej pracy dotyczy syntezy praw sterowania systemu aktywnego t³umienia flatteru dla koncepcyjnego samolotu bezza³ogowego o budowie i charakterystyce zbli¿onej do istniej¹cego samolotu MQ-1 Predator (Rys.~\ref{RysPredator}).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth*3/4]{Predator.jpg}
\caption{Obiekt sterowania - samolot bezza³ogowy MQ-1 Predator. ród³o: Wikipedia}
\label{RysPredator}
\end{figure}

Najwa¿niejszym elementem obiektu jet skrzyd³o podlegaj¹ce flatterowi. Struktura modelu skrzyd³a zosta³a zaczerpniêta z projektu BACT, prowadzonego w NASA Langley \cite{WaszakModel}. Projekt zak³ada³ opracowanie wysoko wiarygodnego modelu skrzyd³a, którego zgodnoœæ z rzeczywistoœci¹ potwierdzono w trakcie licznych badañ w tunelu aerodynamicznym. Parametry modelu zosta³y odpowiednio przeskalowane, lub na nowo wyliczone tak, aby odpowiada³y rozpatrywanemu samolotowi Predator.

Niniejsza praca zosta³a podzielona na dwie fazy:
\begin{itemize}
\item \emph{Faza 1.} Dotyczy t³umienia flatteru samego skrzyd³a o dwóch stopniach swobody.
\item \emph{Faza 2.} Dotyczy t³umienia flatteru skrzyd³a samolotu w locie swobodnym.
\end{itemize}
W zwi¹zku z powy¿szym, w \emph{fazie 1.} rolê obiektu pe³ni model elastycznego skrzyd³a. W \emph{fazie 2.} obiektem sterowania jest model ca³ego samolotu w locie swobodnym, w którego sk³ad wchodzi model skrzyd³a z \emph{fazy 1.}.

\section{Robust control}

TODO

Czym jest robust control, pojêcie niepewnoœci. Model nominalny, model rzeczywisty. Odpornoœæ - odporna stabilnoœæ, odporna charakterystyka (osi¹gi, performance).

Dlaczego robust control jest odpowiednie dla tej klasy problemów?

Statki powietrzne z za³o¿enia pracuj¹ w bardzo zmiennym œrodowisku (du¿e zakresy prêdkoœci, wysokoœci lotu, zmiana masy). Do tego modele opisuj¹ce skomplikowane zjawiska aerodynamiczne musz¹ byæ czêsto powa¿nie uproszczone dla uzyskania odpowiedniej z³o¿onoœci obliczeniowej.

Z tego powodu technika sterowania odpornego (robust control), wydaje siê byæ idealna do zastosowania w problemie t³umienia flatteru.


\chapter{Podstawy teoretyczne}

\section{Dynamiczny uk³ad liniowy stacjonarny}
Obiekt, czyli fizyczny uk³ad dynamiczny mo¿e byæ opisany w dziedzinie czasu za pomoc¹ równañ stanu, albo w dziedzinie czêstotliwoœci za pomoc¹ macierzy transmitancji operatorowych. W niniejszej pracy s¹ u¿ywane prawie wy³¹cznie modele liniowe w standardowej postaci \eqref{ModelSS}.

\begin{equation}
\begin{split}
\dot{x}(t) &= A  x(t) + B  y(t)\\
y &= C  x(t) + D  y(t)
\end{split}
\label{ModelSS}
\end{equation}

Dowolny model liniowy o skoñczonej liczbie wymiarów mo¿na przedstawiæ w postaci macierzy transmitancji \(G(s)\), któr¹ w sposób bezpoœredni otrzymujemy z opisu w przestrzeni stanów:

\begin{equation}
G(s) = C(sI - A)^{-1} B + D
\end{equation}

W niniejszej pracy uk³ad bêdzie oznaczany wielk¹ liter¹ niezale¿nie od postaci opisu matematycznego (np. \( G_r \)). Czasami dla podkreœlenia, ¿e mamy do czynienia z macierz¹ transmitancji zostanie zapisany w pe³nej formie \( G_r(s) \), lub odpowiednio \(G_r(j\omega)\) dla transmitancji widmowej.

Je¿eli wspó³czynniki równañ nie zale¿¹ od czasu mamy do czynienia z uk³adami stacjonarnymi. Chocia¿ z punktu widzenia charakteru zjawisk fizycznych, obiekt pracuj¹cy w zmiennym œrodowisku jest obiektem niestacjonarnym, to zazwyczaj opisuje siê go jako rodzina modeli stacjonarnych. Jest to o tyle s³uszne za³o¿enie, o ile zmiennoœæ parametrów jest du¿o wolniejsza od dynamiki obiektu.

\section{Metody analizy uk³adów wielowymiarowych}
W przypadku systemów jednowymiarowych, analiza w dziedzinie czêstotliwoœci sprowadza siê do okreœlenia wzmocnienia i przesuniêcia fazowego odpowiedzi uk³adu na sinusoidalne wymuszenie. Charakterystykê czêstotliwoœciow¹ opisan¹ transmitancj¹ widmow¹ \(G(j \omega) \) uk³adu otrzymujemy bezpoœrednio podstawiaj¹c \( s = j \omega \) do transmitancji operatorowej.

Gdy mamy do czynienia z systemem wielowymiarowym, na charakter odpowiedzi czêstotliwoœciowej maj¹ wp³yw wzglêdne wielkoœci i przesuniêcia fazowe poszczególnych sk³adników wektora wejœciowego. Sygna³ wejœciowy mo¿emy  przedstawiæ nastêpuj¹co: 

\begin{equation}
u(t) = \tilde{u}e^{j \omega t},
\end{equation}

gdzie \(\tilde{u}\) to ustalony wektor wartoœci zespolonych, zwany w skrócie \emph{kierunkiem} sygna³u wejœciowego. Poniewa¿ pozwalamy, aby wektor \( \tilde{u} \) by³ zespolony, poszczególne sk³adowe wektora \( u(t) \) mog¹ byæ w dowolnej fazie wzglêdem pozosta³ych.

Odpowiedzi¹ uk³adu \( G(s) \) na tak skonstruowane wejœcie, bêdzie 

\begin{equation}
y(t) = \tilde{y} e^{j \omega t},
\end{equation}

gdzie \( \tilde{y} = G(j \omega) \tilde{u} \). 

Jak wynika z powy¿szego rozumowania, analiza uk³adów wielowymiarowych jest dodatkowo utrudniona z tego  wzglêdu, ¿e na wzmocnienie uk³adu wp³ywa nie tylko czêstotliwoœæ sygna³u wejœciowego, ale równie¿ wielkoœæ i faza jego poszczególnych sk³adowych, czyli kierunek.

Bardzo czêsto chcielibyœmy znaæ odpowiedŸ na pytanie: dla jakiego ograniczonego sygna³u wejœciowego dla danej czêstotliwoœci otrzymamy najwiêksze wzmocnienie uk³adu? Innymi s³owy chcielibyœmy znaæ wzmocnienie w najgorszym przypadku. Z pomoc¹ w tej sytuacji przychodzi narzêdzie matematyczne zwane dekompozycj¹ macierzy wed³ug wartoœci osobliwej.

\subsection{Wartoœci osobliwe macierzy}

\begin{definition}
\cite{Handbook} Dowolnej macierzy \(A\) rzêdu k, mo¿emy przypisaæ k dodatnich wartoœci oznaczanymi jako \( \sigma_i(A) \) lub w skrócie \( \sigma_i\). S¹ to wartoœci osobliwe macierzy \(A\) obliczane jako dodatni pierwiastek z wartoœci w³asnej \(A^HA\) , lub \(AA^H\), to jest
\begin{equation}
\sigma_i(A) = \sqrt{\sigma_i(A^HA)} > 0, i = 1...k,
\end{equation}
gdzie \( \lambda_i(\cdot) \) oznacza i-t¹ niezerow¹ wartoœæ w³asn¹. Wartoœci osobliwe przyjê³o siê szeregowaæ malej¹co:
\begin{equation}
\sigma_{\max} = \sigma_1 \geq \sigma_2 \geq ... \geq \sigma_k = \sigma_{\min}
\nonumber
\end{equation}
\end{definition}

Wybrane w³asnoœci wartoœci osobliwej macierzy:
\begin{align}
& \sigma(\alpha M) = \left| \alpha \right| \sigma(M) \\
& \sigma_{\max}(M_1 + M_2) \leq \sigma_{\max}(M_1) + \sigma_{\max}(M_2) 
\label{WlSigmaPlus}\\
& \sigma_{\max}(M_1 \cdot M_2) \leq \sigma_{\max}(M_1) \cdot \sigma_{\max}(M_2) 
\label{WlSigmaMnozenie} \\
& \sigma_{\max}(M) = \max_{|x| = 1}\| Mx \|_2 = \| M \|_2 
\label{WlSigmaMax} \\
& \sigma_{\min}(M) = \min_{|x| = 1}\| Mx \|_2
\end{align}

Z w³asnoœci \eqref{WlSigmaMax} wynika, ¿e \( \sigma_{\max} \) macierzy transmitancji widmowych dla pewnej czêstotliwoœci \( \omega_0 \) okreœla maksymalne wzmocnienie uk³adu dla dowolnego (co do kierunku) sygna³u wejœciowego.

\subsection{Dekompozycja macierzy wed³ug wartoœci osobliwych}
% Ewewntualnie krótszy tytu³ {Dekompozycja SVD}
Bardzo ciekawym narzêdziem do analizy systemów wielowymiarowych (MIMO) w dziedzinie czêstotliwoœci jest dekompozycja macierzy wed³ug wartoœci osobliwych (dekompozycja SVD, od ang. Singular Value Decompozition)

Dla dowolnej czêstotliwoœci \( \omega_0 \) wartoœæ transmitancji widmowej \( G(j \omega_0) \) jest pewn¹ macierz¹ liczb zespolonych. Dokonuj¹c dekompozycji SVD macierzy \( G(j \omega_0) \) otrzymamy:

\begin{equation}
G(j \omega_0)= U \Sigma V^T,
\end{equation}

lub po przekszta³ceniu: 

\begin{equation}
G(j \omega_0) V = U \Sigma,
\end{equation}

gdzie \( \Sigma \) to diagonalna macierz zawieraj¹ca na swojej przek¹tnej kolejne wartoœci osobliwe. Pionowe wektory macierzy \(U\) i \(V\) s¹ wzglêdem siebie ortonormalne.

Dla dowolnego \(i = 1...n\) zachodzi zale¿noœæ:

\begin{equation}
u_i \cdot \sigma_i = G(j \omega_0) \cdot v_i,
\end{equation}

gdzie \( u_i \) to i-ty wektor macierzy \(U\), a \(v_i\) - i-ty wektor macierzy V. Wektory \( u_i i v_i \) nale¿y interpretowaæ jako kierunki odpowiednio sygna³u wyjœciowego i wejœciowego, natomiast \( \sigma_i \) jest wzmocnieniem uk³adu. W szczególnoœci, dla \( i = 1 \) otrzymamy maksymalne wzmocnienie uk³adu \(\sigma_{\max} = \sigma_1 \) oraz sygna³ wymuszaj¹cy prowadz¹cy do tego wzmocnienia, czyli w skrócie \emph{najgorszy przypadek}.

\subsubsection{Przyk³ad - F18}
Model poprzecznej dynamiki samolotu F18 posiada trzy sygna³y wejœciowe: \(\delta_a\) - wychylenie lotki, \(\delta_r\) - wychylenie steru kierunku, \(\delta_s\) - wychylenie steru wysokoœci; dwa sygna³y wyjœciowe: \(p\) - prêdkoœæ k¹towa przychylania [deg/s], \(\beta\) - k¹t œlizgu [deg]; oraz osiem stanów. Macierze opisuj¹ce model w przestrzeni stanów zosta³y zaczerpniête z \cite{MacLean} i znajduj¹ siê w za³¹czniku \ref{F18Zalacznik}.

Obliczaj¹c najwiêksz¹ wartoœæ osobliw¹ transmitancji widmowej modelu dla pewnego przedzia³u \(\omega\), otrzymujemy maksymalne mo¿liwe wzmocnienie uk³adu po wszystkich kierunkach sygna³u wejœciowego (czarna linia - rys. \ref{RysSvdF18}). Dodatkowo wykorzystuj¹c dekompozycjê SVD, otrzymamy wzglêdny udzia³ poszczególnych sk³adowych sygna³u wejœciowego i wyjœciowego.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{SvdF18.eps}
\caption{Analiza SVD modelu poprzecznej dynamiki samolotu F18.}
\label{RysSvdF18}
\end{figure}


Z takiej analizy wynika, ¿e w sygnale wyjœciowym, niezale¿nie od czêstotliwoœci, dominuje prêdkoœæ przechylania \(q\). Natomiast g³ówne sk³adniki sygna³u wejœciowego, generuj¹ce du¿e wzmocnienie uk³adu, to lotki i ster wysokoœci. Tylko w pewnym w¹skim przedziale pulsacji (w okolicy 1 rad/s) to ster kierunki ma najbardziej destabilizuj¹ce w³aœciwoœci.

Nale¿y zwróciæ uwagê na to, ¿e norma wektora jest silnie uzale¿niona od jednostek elementów sk³adowych. Subiektywnie niewielka wartoœæ sygna³u mo¿e okazaæ siê obiektywnie dominuj¹ca, dlatego do wiarygodnej analizy za pomoc¹ tego narzêdzia niezbêdna jest normalizacja sygna³ów, lub u¿ycie funkcji wagowych. 

W powy¿szym przyk³adzie, spoœród elementów sygna³u wyjœciowego, to wartoœæ \(q\) przewa¿a nad \(\beta\). Jednak subiektywna ocena, mo¿e byæ uzale¿niona od wymagañ odnoœnie w³aœciwoœci lotnych.

\subsection{Normalizacja sygna³ów}
TODO Chodzi o to, ¿eby na wejœciu i na wyjœcia przyjmowa³y wartoœci z przedzia³u <-1,1>. Maksymalna amplituda równa 1, ewentualnie wariancja sygna³u losowego równa 1.

% rozwi¹zanie - wy³¹czenie bookmarków (hyperrref), albo:
% \latexorpdf{math}{non math}
% \section{Norma \( H_{\infty} \)}
\subsection{Norma Hinf}

Jak wynika z analizy na temat dekompozycji SVD, najwiêksza wartoœæ osobliwa transmitancji widmowej okreœla wzmocnienie w najgorszym przypadku dla danej czêstotliwoœci. Normê \( H_{\infty} \) zdefiniowan¹ w nastêpuj¹cy sposób:
\begin{equation}
H_\infty (G(s)) = \sup_{\omega} \sigma_{\max}(G(j\omega))
\end{equation}
mo¿na zinterpretowaæ jako maksymalne wzmocnienie w dowolnym kierunku i dla dowolnej czêstotliwoœci. Norma ma szczególne zastosowanie do badania odpornej stabilnoœci uk³adu (Small Gain Theorem).

\section{Niepewnoœæ}

Analiza, lub synteza uk³adów regulacji opiera siê na modelu matematycznym obiektu fizycznego. Model matematyczny zawsze jest tylko przybli¿eniem rzeczywistoœci. Ró¿nica miêdzy modelem a rzeczywistym obiektem jest nazywana niepewnoœci¹ modelu matematycznego.

Typowe Ÿród³a niepewnoœci mo¿na podzieliæ na zamierzone i niezamierzone. Do pierwszej grupy nale¿y np. œwiadome pominiêcie skomplikowanych zjawisk fizycznych (tzw. niemodelowana dynamika), linearyzacja uk³adu lub efekt redukcji rzêdu uk³adu. Do niezamierzonych Ÿróde³ mo¿na zaliczyæ b³¹d pomiarowy przy identyfikacji obiektu lub zmiana (zaburzenie) parametrów pracy ze wzglêdu na zmianê czynników zewnêtrznych jak temperatura czy wilgotnoœæ.

Skoro obiekt rzeczywisty mo¿e w pewnym zakresie zmieniaæ swoje w³aœciwoœci dynamiczne, mo¿emy mówiæ o pewnej rodzinie (zbiorze) obiektów \( \mathcal{G}_r \). Gdybyœmy w dowolnym punkcie pracy byli w stanie wyznaczyæ model \( G_r \) obiektu, to model ten nale¿a³by do zbioru \( \mathcal{G}_r \).

Chocia¿ nazwa mo¿e byæ mylna, w dziedzinie sterowania odpornego niepewnoœæ jest nasz¹ {\bf wiedz¹} na temat mo¿liwych odchyleñ obiektu rzeczywistego od za³o¿onego modelu nominalnego. Je¿eli przy opisie obiektu uwzglêdnimy tê wiedzê (czyli niepewnoœæ), otrzymamy {\bf model uk³adu z niepewnoœci¹}~\cite{Buslowicz}. Taki model definiuje pewn¹ rodzinê modeli, któr¹ w niniejszej pracy oznaczono jako \( \mathcal{G}_p \).

Problem opracowania modelu z niepewnoœci¹ mo¿na sformu³owaæ nastêpuj¹co:\\
{ \it Dla znanej rodziny obiektów \( \mathcal{G}_r \) znajdŸ tak¹ rodzinê modeli \( \mathcal{G}_p \) opisan¹ pewnym modelem niepewnoœci \(G_p(s)\), aby zbiór \( \mathcal{G}_r \) by³ zawarty w zbiorze \( \mathcal{G}_p \):
}
\begin{equation}
\mathcal{G}_r \subset \mathcal{G}_p
\label{GrInGp}
\end{equation}

Powy¿sz¹ zale¿noœæ ilustruje Rys.~\ref{RysZbiory}.

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth * 3/4]{ZbioryObiektow.png}
\caption{Interpretacja niepewnoœci.}
\label{RysZbiory}
\end{figure}

\subsection{Niepewnoœæ parametryczna}
Model niepewnoœci parametrycznej nadaje siê idealnie do sytuacji, gdy jesteœmy pewni co do struktury modelu (struktury równañ matematycznych), ale spodziewamy siê pewnej zmiennoœci wspó³czynników opisuj¹cych obiekt rzeczywisty. Np. dla modelu liniowego w przestrzeni stanów, uwzglêdniaj¹c wp³yw parametrów na postaæ macierzy, otrzymamy:

\begin{equation}
\begin{split}
\dot{x}(t) &= A(q) \cdot x(t) + B(q) \cdot y(t),\\
y &= C(q) \cdot x(t) + D(q) \cdot y(t),
\end{split}
\label{NiepParam}
\end{equation}
przy czym \( q \in Q \), gdzie \( q = [q_1, q_2, ... ,q_m]^T \) jest wektorem niepewnych parametrów, a elementy macierzy \( A(q), B(q), C(q), D(q) \) s¹ ci¹g³ymi funkcjami. Wektor \( q \) mo¿e przyjmowaæ wartoœci ze zbioru \( Q \), który zazwyczaj okreœla siê nastêpuj¹co:

\begin{equation}
Q = \{ q: \quad q_k \in [q_k^{-}, q_k^{+}], \quad q_k^{-} < q_k^{+}, \quad k = 1...m\}.
\label{ZbiorQ}
\end{equation}

Analogicznie, model w dziedzinie czêstotliwoœci bêdzie mia³ postaæ nieskoñczonej rodziny macierzy transmitancji operatorowych:
\begin{equation}
\{ G(s,q), \quad q \in Q \},
\end{equation}
gdzie zbiór \( Q \) jest okreœlony identycznie jak poprzednio \eqref{ZbiorQ}.

\subsection{Niepewnoœæ niestrukturalna}



\subsubsection{Model wzglêdnej (multiplikatywnej) niepewnoœci na wejœciu}
\begin{equation}
G_p(s) = G_n(s)(I + w_i(s) \Delta(s))
\label{NiepWzglIn}
\end{equation}
\subsubsection{Model wzglêdnej (multiplikatywnej) niepewnoœci na wyjœciu}
\begin{equation}
G_p(s) = (I + w_o(s) \Delta(s))G_n(s)
\label{NiepWzglOut}
\end{equation}
\subsubsection{Model bezwzglêdnej (addytywnej) niepewnoœci}
\begin{equation}
G_p(s) = G_n(s) + w_a(s) \Delta(s)
\label{NiepBezwzgl}
\end{equation}

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{ModeleNiepewnosci.png}
\caption{Modele niestrukturalnej niepewnoœci, a) wzglêdnej na wejœciu, b) wzglêdnej na wyjœciu, c) bezwzglêdnej}
\label{RysModeleNiep}
\end{figure}


Dowolny z modeli niepewnoœci niestrukturalnej mo¿na przedstawiæ z pomoc¹ innego, dlatego ka¿dy z modeli mo¿e byæ stosowany wymiennie (TODO Ÿród³o). Z tego powodu w dalszej czêœci pracy bêdzie stosowany tylko jeden, a konkretnie model niepewnoœci wzglêdnej na wyjœciu uk³adu.

\subsection{Metoda doboru funkcji wagowej}

Z postaci modelu niepewnoœci \eqref{NiepWzglIn}, \eqref{NiepWzglOut}, \eqref{NiepBezwzgl} wynika, ¿e do okreœlenia niepewnoœci wymagane jest okreœlenie modelu nominalnego \(G_n\) i funkcji wagowej, która odzwierciedla nasz¹ wiedzê na temat górnej granicy charakterystyki czêstotliwoœciowej obiektu. O ile wybór \(G_n\) nie stanowi problemu (mo¿e to byæ postaæ odpowiadaj¹ca wartoœciom œrednim parametrów obiektu), o tyle wybranie funkcji wagowej wymaga wyjaœnienia.

Poniewa¿ z punktu widzenia odpornej stabilnoœci, kluczowe znaczenie ma norma \( H_\infty \) rozpatrywanego uk³adu (a co za tym idzie - maksymalna wartoœæ osobliwa transmitancji widmowej), interesuje nas znalezienie zbioru \( \mathcal{G}_p\), takiego ¿e
\begin{equation}
\begin{split}
& \forall{G_r \in \mathcal{G}_r} \quad \exists{G_p:} \quad \\ 
& \sigma_{\max}(G_p(j\omega)) \geq \sigma_{\max}(G_r(j\omega)) \quad \forall \omega
\end{split}
\label{GrInGp2}
\end{equation}

Oczywiœcie znalezienie dowolnego zbioru, który spe³nia zale¿noœæ~(\ref{GrInGp2}) jest trywialne, ale nam zale¿y na znalezieniu mo¿liwie najmniejszego, który spe³nia tê zale¿noœæ.

Je¿eli do opisu niepewnoœci wykorzystamy model wzglêdny na wyjœciu uk³adu, (\ref{GrInGp2}) sprowadza siê do:

\begin{equation}
\begin{split}
& \forall G_r \in \mathcal{G}_r \quad \exists G_p: \\
& \sigma_{\max}(G_p(j\omega)) = \sigma_{\max}\left[(I + w_o(j\omega)\Delta(j\omega))G_n(j\omega)\right] \geq \sigma_{\max}(G_r(j\omega))
\quad \forall \omega
\end{split}
\label{SigmaNiepWzgledna}
\end{equation}
Wykorzystuj¹c w³asnoœci wartoœci osobliwej macierzy (\ref{WlSigmaPlus}), (\ref{WlSigmaMnozenie}), otrzymujemy zale¿noœæ na funkcjê wagow¹ \( w_o(s) \), któr¹ nale¿y spe³niæ (\ref{ZaleznoscWo}).

\begin{equation}
\sigma_{\max}(w_o(j\omega)) \geq 
\frac{\sigma_{\max}(G_r(j\omega)) - \sigma_{\max}(G_n(j \omega))}
{\sigma_{\max}(G_n(j \omega))} \quad \forall \omega
\label{ZaleznoscWo}
\end{equation}

Zazwyczaj mamy do czynienia z nieskoñczonym zbiorem \(\mathcal{G}_r\), dlatego w praktycznych zastosowaniach, przez \(\mathcal{G}_r\) bêdziemy rozumieæ {\bf reprezentatywny} zbiór uk³adów.


%\subsubsection{Model multiplikatywny (wzglêdny) niepewnoœci}
%\subsubsection{Model addytywny (bezwzglêdny) niepewnoœci}


\section{Metody syntezy odpornych regulatorów}
TODO: Cecha podejœcia Robust Control - uwzglêdnienie niepewnoœci podczas syntezy regulatora

\subsection{Regulator Hinf}

Synteza regulatora \( H_\infty \) standardowo odbywa siê z wykorzystaniem tzw. { \it nowoczesnego paradygmatu} (modern paradigm) \cite{Handbook}. Zgodnie z tym podejœciem zarówno wymogi osi¹gowe jak i odpornoœciowe mog¹ zostaæ uwzglêdnione w i zrzutowane do postaci uogólnionego modelu \(P\) (Rys. \ref{ModernParadigm}).

\begin{figure}
\centering
\includegraphics[width=\linewidth/2]{ModernParadigm.png}
\caption{Uogólniony model zgodny z nowoczesnym paradygmatem}
\label{ModernParadigm}
\end{figure}

Uk³ad liniowy \( P \) zawiera dynamikê obiektu razem z elementami wykonawczymi i sensorami, model niepewnoœci oraz funkcje wagowe, które projektant dobiera tak, aby uzyskaæ po¿¹dany wynikowy regulator \( K \). Sygna³y pomiarowe wykorzystane do regulacji oznaczono jako \( y \), sygna³ steruj¹cy regulatora - jako \( u \). Elementy wektora \( w \) to zewnêtrze wejœcia uk³adu - zaburzenia, wartoœci zadane regulacji lub szumy pomiarowe. Na wyjœciu jako \( z \) oznaczone s¹ wszystkie wielkoœci, które chcemy sterowaæ. Mog¹ to byæ np. abstrakcyjne wskaŸniki jakoœci regulacji, wa¿ony uchyb lub wysi³ek sterowania.

Ogólny problem mo¿na okreœliæ jako poszukiwanie stabilizuj¹cego regulatora \( K \), który bêdzie minimalizowa³ elementy wektora \( z \), przy wystêpowaniu zewnêtrznego sygna³u \( w \). Chodzi wiêc o minimalizacjê { \it wielkoœci } uk³adu zamkniêtego \( T_{zw}(s) \). Jako miernik tej wielkoœci doskonale spe³nia swoj¹ rolê norma \( H_\infty \).

Sam algorytm wyznaczania sub-optymalnego regulatora \( H_\infty \) jest  wyjaœniony np. w \cite{Handbook}, dlatego nie zostanie tutaj przytoczony. W niniejszej pracy do syntezy regulatora \( H_\infty \) wykorzystano oprogramowanie Matlab oraz zestaw narzêdzi Robust Control Toolbox (funkcja { \it hinfsyn}). W wyniku syntezy otrzymujemy regulator \( K \) oraz wartoœæ skalarn¹ \( \gamma \), która okreœla poziom, do jakiego uda³o siê obni¿yæ normê uk³adu zamkniêtego.

\begin{equation}
\| T_{zw} (s) \|_\infty < \gamma
\end{equation}

Je¿eli otrzymamy \( \gamma < 1 \) oznacza to, ¿e wszystkie kryteria zrzutowane na generyczny model \(P\) zosta³y spe³nione.

Je¿eli norma \( H_\infty \) macierzy transmitancji \( T_{zw} \) jest mniejsza od pewnej wartoœci \( \gamma \), to równie¿ norma elementów macierzy jest mniejsza od \( \gamma \) (\ref{WlasnoscNormyHinf}), co wynika z w³asnoœci maksymalnej wartoœci osobliwej.

\begin{equation}
\| T_{zw} \|_\infty < \gamma \Rightarrow \| (T_{zw})_{ij} \|_\infty < \gamma \quad \forall{i,j}
\label{WlasnoscNormyHinf}
\end{equation}

\( (T_{zw})_{ij} \) oznacza transmitancjê uk³adu zamkniêtego pomiêdzy j-tym zewnêtrznym zaburzeniem \( w_i\), a zmienn¹ charakteryzuj¹c¹ osi¹gi \(z_i\) (TODO performance variable).
Z tego wynika, ¿e model generyczny \( P \) nale¿y tak konstruowaæ, aby w zamkniêtym uk³adzie \( T_{zw} \) znalaz³y siê wszystkie transmitancje, które chcemy kszta³towaæ (loop-shaping) przemno¿one przez funkcje wagowe.

\subsubsection{Interpretacja funkcji wagowych dla uk³adu jednowymiarowego}
TODO: Interpretacja funkcji wagowej dla uk³adu SISO.

Zapisany w takiej formie mo¿e podkreœlaæ znaczenie pewnego sygna³u wyjœciowego w przestrzeni czêstotliwoœci.
\begin{equation}
\| w_p(s) T_{zw}(s) \|_\infty < \gamma
\end{equation}
Natomiast zapisany w takiej formie (przy wykorzystaniu w³asnoœci normy \( H_\infty \) ) mo¿na interpretowaæ jako kszta³towanie charakterystyki czêstotliwoœciowej uk³adu zamkniêtego.
\begin{equation}
\| T_{zw}(s) \|_\infty < \frac{\gamma}{w_p(s)}
\end{equation}


TODO: Przyk³ad. Masa na sprê¿ynie. Ujêcie wymagañ co do sygna³u sterowania i uchybu. Synteza regulatora.

\subsection{Warunek odpornej stabilnoœci}

Warunek odpornej stabilnoœci uk³adu z modelem wzglêdnej niepewnoœci na wyjœciu mo¿na wyprowadziæ z teorii ma³ych wzmocnieñ (Small Gain Theorem)~\cite{Handbook}.

\begin{theorem}
Zak³adaj¹c, ¿e nominalny uk³ad zamkniêty oraz funkcja wagowa \( w_o(s) \) s¹ stabilne, warunkiem {\bf wystarczaj¹cym} odpornej stabilnoœci rodziny uk³adów o postaci
\begin{equation}
\mathcal{G}_p = \{ G_p(s) : G_p(s) = (I + w_o(s)\Delta(s))G_n(s), \|\Delta(s)\|_\infty \leq 1 \}
\end{equation}
jest spe³nienie zale¿noœci:
\begin{equation}
\| w_o(s)G(s)K(s)(I + G(s)K(s))^{-1} \|_\infty < 1
\label{MultStability}
\end{equation}
\end{theorem}

Nale¿y zaznaczyæ, ¿e warunek wystarczaj¹cy (\ref{MultStability}), mo¿e byæ zbyt zachowawczy i nie zostanie spe³niony nawet dla odpornie stabilnego uk³adu.

\subsubsection{Przyk³ad - uk³ad masa-sprê¿yna-t³umik}
Masa \( m \), której ruchowi towarzyszy tarcie lepkie o wspó³czynniku t³umienia \( c \), jest zamocowana na sprê¿ynie o sztywnoœci \( k \). Parametry uk³adu s¹ niepewne, a ich wartoœci nominalne i zakresy zmiennoœci wynosz¹:
\begin{align}
m &= 3 \pm 60 \%,\\
c &= 1 \pm 60 \%,\\
k &= 2 \pm 40 \%.
\end{align}
Sygna³em wejœciowym jest si³a przy³o¿ona do masy \( f(x) \), sygna³em wyjœciowym - po³o¿enie masy \( x(t) \).

W pierwszym podejœciu zaprojektowano regulator \( H_\infty \), przy czym waga dotycz¹ca sygna³u steruj¹cego \( w_u(s) = 0,01 \), natomiast waga b³êdu sterowania \( e(t) \) wynosi:
\begin{equation}
w_p(s) = 0,95 \frac{s^2 + 1,8s + 10}{s^2 + 8s + 0,01}.
\nonumber
\end{equation}


Kryteria jakoœciowe zdefiniowane funkcjami wagowymi \( w_u(s) \) i \( w_p(s) \) zosta³y spe³nione (\(\gamma < 1 \)), ale uk³ad zamkniêty okaza³ siê niestabilny dla pewnych wartoœci parametrów \( m, c\) i \(k\).

W kolejnym etapie uwzglêdniono zmiennoœæ parametrów w postaci wzglêdnego modelu niepewnoœci. Wagê \( w_o(s) \) dobrano tak, aby powsta³a rodzina modeli objê³a rodzinê obiektów \( \mathcal{G}_r \subset \mathcal{G}_p \) (rys. \ref{MsdUncert}).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{MsdUncert.eps}
\caption{Dobór funkcji wagowej modelu niepewnoœci.}
\label{MsdUncert}
\end{figure}

Okazuje siê, ¿e chocia¿ kryteria jakoœciowe (w tym kryterium odpornoœci) nie zosta³y spe³nione (\( \gamma = 2,56 \)), uk³ad zamkniêty jest odpornie stabilny. Samo uwzglêdnienie niepewnoœci pozwoli³o osi¹gn¹æ odporn¹ stabilnoœæ. Na rys.~(\ref{Msd2}) porównano transmitancje widmowe uk³adu zamkniêtego \( G(s)K(s)(I+G(s)K(s))^{-1} \) dwóch regulatorów, które dla spe³nienia warunku wystarczaj¹cego kryterium stabilnoœci, powinny byæ mniejsze od \( 1/w_o(j\omega) \) dla ka¿dego \( \omega \geq 0 \).

\begin{figure}[hbt]
\centering
\includegraphics[width=\linewidth]{Msd2.eps}
\caption{Chocia¿ warunek wystarczaj¹cy nie zosta³ spe³niony, regulator 2. jest odpornie stabilny.}
\label{Msd2}
\end{figure}

